(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==t(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===t(i)?i:String(i)),r)}var i}var n=function(){function t(e,n,o,r,i,u,c,l,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._title=e,this._link=n,this._likes=o,this._id=r,this._ownerId=i,this._openFullImagePopup=u,this._openDeleteCardPopup=c,this._putLikeApi=l,this._deleteLikeApi=a,this._templateSelector=s,this._content=document.querySelector(this._templateSelector).content.querySelector(".photo-grid__element"),this._myId="425d54141212510c853cf047"}var n,o;return n=t,(o=[{key:"_getTemplateCard",value:function(){return this._content.cloneNode(!0)}},{key:"_putLike",value:function(){var t=this;this._putLikeApi(this._id).then((function(e){return t._likesCount.textContent=e.likes.length})).catch((function(t){console.log(t)})),this._like.classList.add("photo-grid__like_active")}},{key:"_deleteLike",value:function(){var t=this;this._deleteLikeApi(this._id).then((function(e){return t._likesCount.textContent=e.likes.length})).catch((function(t){console.log(t)})),this._like.classList.remove("photo-grid__like_active")}},{key:"_setEventListeners",value:function(){var t=this;this._like.addEventListener("click",(function(){t._like.classList.contains("photo-grid__like_active")?t._deleteLike():t._putLike()})),this._newCard.querySelector(".photo-grid__delete-button").addEventListener("click",(function(){return t._openDeleteCardPopup(t._newCard,t._id)})),this._img.addEventListener("click",(function(){return t._openFullImagePopup(t._title,t._link)}))}},{key:"_setData",value:function(){this._newCard.querySelector(".photo-grid__title").textContent=this._title,this._img.src=this._link,this._img.alt=this._title,this._likesCount.textContent=this._likes.length}},{key:"_checkId",value:function(){var t,e=this;return this._likes.forEach((function(n){t=n._id===e._myId})),t}},{key:"getView",value:function(){return this._newCard=this._getTemplateCard(),this._img=this._newCard.querySelector(".photo-grid__photo"),this._like=this._newCard.querySelector(".photo-grid__like"),this._likesCount=this._newCard.querySelector(".photo-grid__likes-counter"),this._setEventListeners(),this._setData(),this._myId!==this._ownerId&&this._newCard.querySelector(".photo-grid__delete-button").remove(),this._checkId()&&this._like.classList.add("photo-grid__like_active"),this._newCard}}])&&e(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===o(i)?i:String(i)),r)}var i}var i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._config=e,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.buttonSelector)}var e,n;return e=t,(n=[{key:"_hideInputError",value:function(t){this._formElement.querySelector(".".concat(t.id,"-error")).textContent="",t.classList.remove(this._config.redBorderClass)}},{key:"_showInputError",value:function(t){this._formElement.querySelector(".".concat(t.id,"-error")).textContent=t.validationMessage,t.classList.add(this._config.redBorderClass)}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(t){return!t.validity.valid}))}},{key:"_disableSubmitButton",value:function(){this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0}},{key:"_enableSubmitButton",value:function(){this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?this._disableSubmitButton():this._enableSubmitButton()}},{key:"_setEventListeners",value:function(){var t=this;this._toggleButtonState(),this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"clearErrors",value:function(){var t=this;this._toggleButtonState(),this._inputList.forEach((function(e){t._hideInputError(e)}))}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==u(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===u(r)?r:String(r)),o)}var r}var l=function(){function t(e,n){var o=e.items,r=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items=o,this._renderer=r,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderItems",value:function(){var t=this;this._items.forEach((function(e){return t._renderer(e)}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===a(r)?r:String(r)),o)}var r}var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}var e,n;return e=t,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close()}},{key:"setEventListeners",value:function(){this._popup.querySelector(".popup__close-button").addEventListener("click",this.close.bind(this)),this._popup.querySelector(".popup__overlay").addEventListener("click",this.close.bind(this))}}])&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==p(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===p(r)?r:String(r)),o)}var r}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},h.apply(this,arguments)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(u,t);var e,n,o,r,i=(o=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=v(o);if(r){var n=v(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._popupImage=e._popup.querySelector(".popup__img"),e._popupImageTitle=e._popup.querySelector(".popup__img-title"),e}return e=u,(n=[{key:"open",value:function(t,e){this._popupImage.src=e,this._popupImage.alt=t,this._popupImageTitle.textContent=t,h(v(u.prototype),"open",this).call(this)}}])&&y(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(f);function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function m(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==_(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==_(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===_(r)?r:String(r)),o)}var r}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},g.apply(this,arguments)}function S(t,e){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},S(t,e)}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}(u,t);var e,n,o,r,i=(o=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=w(o);if(r){var n=w(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,t))._submit=e,o._loading=n,o._popupForm=o._popup.querySelector(".popup__form"),o._inputList=o._popupForm.querySelectorAll(".popup__input"),o}return e=u,(n=[{key:"_getInputValues",value:function(){var t={};return this._inputList.forEach((function(e){t[e.id]=e.value})),t}},{key:"setEventListeners",value:function(){var t=this;g(w(u.prototype),"setEventListeners",this).call(this),this._popupForm.addEventListener("submit",(function(e){e.preventDefault(),t._loading(!0,t._popupForm),t._submit(t._getInputValues(),t._popupForm)}))}},{key:"close",value:function(){g(w(u.prototype),"close",this).call(this),this._popupForm.reset()}}])&&m(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(f);function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function j(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==E(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==E(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===E(r)?r:String(r)),o)}var r}var O=function(){function t(e){var n=e.name,o=e.vocation;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=n,this._vocation=o}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,vocation:this._vocation.textContent}}},{key:"setUserInfo",value:function(t){this._name.textContent=t.name,this._vocation.textContent=t.about}}])&&j(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function C(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==P(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==P(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===P(r)?r:String(r)),o)}var r}var L=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e.url,this.headers=e.headers}var e,n;return e=t,(n=[{key:"getInfo",value:function(){return fetch(this.url,{headers:this.headers}).then(I)}},{key:"saveInfo",value:function(t){return fetch(this.url,{method:"PATCH",headers:{authorization:"dacb1343-5ee5-4c35-990d-5bf7b2f7cc79","Content-Type":"application/json"},body:JSON.stringify({name:t.name,about:t.vocation})}).then(I)}},{key:"setAvatar",value:function(t){return fetch("".concat(this.url,"/avatar"),{method:"PATCH",headers:{authorization:"dacb1343-5ee5-4c35-990d-5bf7b2f7cc79","Content-Type":"application/json"},body:JSON.stringify({avatar:t.avatar})}).then(I)}},{key:"createNewCard",value:function(t){return fetch(this.url,{method:"POST",headers:this.headers,body:JSON.stringify({name:t.title,link:t.link})}).then(I)}},{key:"deleteCard",value:function(t){return fetch("".concat(this.url,"/").concat(t),{method:"DELETE",headers:this.headers}).then(I)}},{key:"putLike",value:function(t){return fetch("".concat(this.url,"/").concat(t,"/likes"),{method:"PUT",headers:this.headers}).then(I)}},{key:"deleteLike",value:function(t){return fetch("".concat(this.url,"/").concat(t,"/likes"),{method:"DELETE",headers:this.headers}).then(I)}}])&&C(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function I(t){return t.ok?t.json():Promise.reject(new Error("Ошибка!!!"))}var T={formSelector:".popup__form",inputSelector:".popup__input",buttonSelector:".popup__save-button",inactiveButtonClass:"popup__inactive-button",redBorderClass:"popup__input_red-broder"};function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function R(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==q(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==q(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===q(r)?r:String(r)),o)}var r}function B(){return B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},B.apply(this,arguments)}function x(t,e){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},x(t,e)}function D(t){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},D(t)}var A,V=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}(u,t);var e,n,o,r,i=(o=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=D(o);if(r){var n=D(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._handleButton=e,n}return e=u,(n=[{key:"open",value:function(t,e){this._card=t,this._id=e,B(D(u.prototype),"open",this).call(this)}},{key:"delete",value:function(){this._handleButton(this._id),this._card.remove()}},{key:"setEventListeners",value:function(){var t=this;B(D(u.prototype),"setEventListeners",this).call(this),this._popup.querySelector(".popup__delete-card-button").addEventListener("click",(function(){t.close(),t.delete()}))}}])&&R(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(f),F=document.querySelector(".profile__edit-button"),N=document.querySelector(".profile__add-button"),U=document.querySelector(".profile__avatar-pencil"),z=document.querySelector(".profile__name"),J=document.querySelector(".profile__vocation"),H=document.querySelector(".popup__edit-form"),M=document.querySelector(".popup__add-form"),G=document.querySelector(".popup__avatar-form"),K=document.querySelector("#name"),Q=document.querySelector("#vocation"),W=document.querySelector(".profile__avatar"),X=new i(T,M),Y=new i(T,H),Z=new i(T,G),$=new L({url:"https://nomoreparties.co/v1/cohort-60/users/me",headers:{authorization:"dacb1343-5ee5-4c35-990d-5bf7b2f7cc79"}}),tt=new L({url:"https://mesto.nomoreparties.co/v1/cohort-60/cards",headers:{authorization:"dacb1343-5ee5-4c35-990d-5bf7b2f7cc79","Content-Type":"application/json"}}),et=new O({name:z,vocation:J});tt.getInfo().then((function(t){(A=new l({items:t,renderer:function(t){var e=pt(t.name,t.link,t.likes,t._id,t.owner._id);A.addItem(e.getView())}},".photo-grid")).renderItems()})).catch((function(t){console.log(t)})),$.getInfo().then((function(t){et.setUserInfo(t),W.src=t.avatar})).catch((function(t){console.log(t)}));var nt=new k(".popup_edit",(function(t,e){$.saveInfo(t).then((function(t){et.setUserInfo(t)})).catch((function(t){console.log(t)})).finally((function(){ct(!1,e),nt.close()}))}),ct),ot=new k(".popup_add",(function(t,e){tt.createNewCard(t).then((function(t){var e=pt(t.name,t.link,t.likes,t._id,t.owner._id);A.addItem(e.getView())})).catch((function(t){console.log(t)})).finally((function(){ct(!1,e),ot.close()}))}),ct),rt=new k(".popup_avatar",(function(t,e){$.setAvatar(t).then((function(t){W.src=t.avatar})).catch((function(t){console.log(t)})).finally((function(){ct(!1,e),rt.close()}))}),ct),it=new b(".popup_full-image"),ut=new V(".popup_delete",(function(t){tt.deleteCard(t)}));function ct(t,e){e.querySelector(".popup__save-button").textContent=t?"Сохранение...":"Создать"}function lt(t){return tt.putLike(t)}function at(t){return tt.deleteLike(t)}function st(t,e){it.open(t,e)}function ft(t,e){ut.open(t,e)}function pt(t,e,o,r,i){return new n(t,e,o,r,i,st,ft,lt,at,"#photo-grid__element")}F.addEventListener("click",(function(){var t=et.getUserInfo();K.value=t.name,Q.value=t.vocation,Y.clearErrors(),nt.open()})),N.addEventListener("click",(function(){X.clearErrors(),ot.open()})),U.addEventListener("click",(function(){rt.open()})),ot.setEventListeners(),nt.setEventListeners(),it.setEventListeners(),ut.setEventListeners(),rt.setEventListeners(),X.enableValidation(),Y.enableValidation(),Z.enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoiMHJCQUFxQkEsRUFBSSxXQUNyQixXQUFZQyxFQUFPQyxFQUFNQyxFQUFPQyxFQUFJQyxFQUFTQyxFQUFvQkMsRUFBcUJDLEVBQVlDLEVBQWVDLEksNEZBQWtCLFNBQy9IQyxLQUFLQyxPQUFTWCxFQUNkVSxLQUFLRSxNQUFRWCxFQUNiUyxLQUFLRyxPQUFTWCxFQUNkUSxLQUFLSSxJQUFNWCxFQUNYTyxLQUFLSyxTQUFXWCxFQUNoQk0sS0FBS00sb0JBQXNCWCxFQUMzQkssS0FBS08scUJBQXVCWCxFQUM1QkksS0FBS1EsWUFBY1gsRUFDbkJHLEtBQUtTLGVBQWlCWCxFQUN0QkUsS0FBS1Usa0JBQW9CWCxFQUN6QkMsS0FBS1csU0FBV0MsU0FBU0MsY0FBY2IsS0FBS1UsbUJBQW1CSSxRQUMxREQsY0FBYyx3QkFDbkJiLEtBQUtlLE1BQVEsMEJBQ2pCLEMsUUE0RUMsTyxFQTVFQSxHLEVBQUEsK0JBRUQsV0FFSSxPQURhZixLQUFLVyxTQUFTSyxXQUFVLEVBRXpDLEdBQUMsc0JBRUQsV0FBVyxXQUNQaEIsS0FBS1EsWUFBWVIsS0FBS0ksS0FDckJhLE1BQUssU0FBQ0MsR0FBSSxPQUFNLEVBQUtDLFlBQVlDLFlBQWNGLEVBQUsxQixNQUFNNkIsTUFBTSxJQUNoRUMsT0FBTSxTQUFDQyxHQUNKQyxRQUFRQyxJQUFJRixFQUNoQixJQUVBdkIsS0FBSzBCLE1BQU1DLFVBQVVDLElBQUksMEJBQzdCLEdBQUMseUJBRUQsV0FBYyxXQUNWNUIsS0FBS1MsZUFBZVQsS0FBS0ksS0FDeEJhLE1BQUssU0FBQ0MsR0FBSSxPQUFNLEVBQUtDLFlBQVlDLFlBQWNGLEVBQUsxQixNQUFNNkIsTUFBTSxJQUNoRUMsT0FBTSxTQUFDQyxHQUNKQyxRQUFRQyxJQUFJRixFQUNoQixJQUVBdkIsS0FBSzBCLE1BQU1DLFVBQVVFLE9BQU8sMEJBQ2hDLEdBQUMsZ0NBRUQsV0FBcUIsV0FDakI3QixLQUFLMEIsTUFBTUksaUJBQWlCLFNBQVMsV0FDN0IsRUFBS0osTUFBTUMsVUFBVUksU0FBUywyQkFDOUIsRUFBS0MsY0FFTCxFQUFLQyxVQUViLElBQ0FqQyxLQUFLa0MsU0FBU3JCLGNBQWMsOEJBQThCaUIsaUJBQWlCLFNBQVMsa0JBQU0sRUFBS3ZCLHFCQUFxQixFQUFLMkIsU0FBVSxFQUFLOUIsSUFBSSxJQUM1SUosS0FBS21DLEtBQUtMLGlCQUFpQixTQUFTLGtCQUFNLEVBQUt4QixvQkFBb0IsRUFBS0wsT0FBUSxFQUFLQyxNQUFNLEdBQy9GLEdBQUMsc0JBRUQsV0FDa0JGLEtBQUtrQyxTQUFTckIsY0FBYyxzQkFDcENPLFlBQWNwQixLQUFLQyxPQUN6QkQsS0FBS21DLEtBQUtDLElBQU1wQyxLQUFLRSxNQUNyQkYsS0FBS21DLEtBQUtFLElBQU1yQyxLQUFLQyxPQUNyQkQsS0FBS21CLFlBQVlDLFlBQWNwQixLQUFLRyxPQUFPa0IsTUFDL0MsR0FBQyxzQkFFRCxXQUFXLElBQ0hpQixFQURHLE9BU1AsT0FQQXRDLEtBQUtHLE9BQU9vQyxTQUFRLFNBQUNDLEdBRWJGLEVBREFFLEVBQUtwQyxNQUFRLEVBQUtXLEtBSzFCLElBQ091QixDQUNYLEdBQUMscUJBRUQsV0FnQkksT0FmQXRDLEtBQUtrQyxTQUFXbEMsS0FBS3lDLG1CQUNyQnpDLEtBQUttQyxLQUFPbkMsS0FBS2tDLFNBQVNyQixjQUFjLHNCQUN4Q2IsS0FBSzBCLE1BQVExQixLQUFLa0MsU0FBU3JCLGNBQWMscUJBQ3pDYixLQUFLbUIsWUFBY25CLEtBQUtrQyxTQUFTckIsY0FBYyw4QkFDL0NiLEtBQUswQyxxQkFDTDFDLEtBQUsyQyxXQUVEM0MsS0FBS2UsUUFBVWYsS0FBS0ssVUFDcEJMLEtBQUtrQyxTQUFTckIsY0FBYyw4QkFBOEJnQixTQUcxRDdCLEtBQUs0QyxZQUNMNUMsS0FBSzBCLE1BQU1DLFVBQVVDLElBQUksMkJBR3RCNUIsS0FBS2tDLFFBQ2hCLE0sb0VBQUMsRUEzRm9CLEcsdXFCQ0FKVyxFQUFhLFdBQzlCLFdBQVlDLEVBQVFDLEksNEZBQWEsU0FDN0IvQyxLQUFLZ0QsUUFBVUYsRUFDZjlDLEtBQUtpRCxhQUFlRixFQUNwQi9DLEtBQUtrRCxXQUFhQyxNQUFNQyxLQUFLcEQsS0FBS2lELGFBQWFJLGlCQUFpQnJELEtBQUtnRCxRQUFRTSxnQkFDN0V0RCxLQUFLdUQsZUFBaUJ2RCxLQUFLaUQsYUFBYXBDLGNBQWNiLEtBQUtnRCxRQUFRUSxlQUN2RSxDLFFBK0RDLE8sRUEvREEsRyxFQUFBLDhCQUVELFNBQWdCQyxHQUNTekQsS0FBS2lELGFBQWFwQyxjQUFjLElBQUQsT0FBSzRDLEVBQWFoRSxHQUFFLFdBQzNEMkIsWUFBYyxHQUMzQnFDLEVBQWE5QixVQUFVRSxPQUFPN0IsS0FBS2dELFFBQVFVLGVBQy9DLEdBQUMsNkJBRUQsU0FBZ0JELEdBQ1N6RCxLQUFLaUQsYUFBYXBDLGNBQWMsSUFBRCxPQUFLNEMsRUFBYWhFLEdBQUUsV0FDM0QyQixZQUFjcUMsRUFBYUUsa0JBQ3hDRixFQUFhOUIsVUFBVUMsSUFBSTVCLEtBQUtnRCxRQUFRVSxlQUM1QyxHQUFDLGlDQUVELFNBQW9CRCxHQUNaQSxFQUFhRyxTQUFTQyxNQUN0QjdELEtBQUs4RCxnQkFBZ0JMLEdBRXJCekQsS0FBSytELGdCQUFnQk4sRUFFN0IsR0FBQyw4QkFFRCxXQUNJLE9BQU96RCxLQUFLa0QsV0FBV2MsTUFBSyxTQUFDUCxHQUFZLE9BQU1BLEVBQWFHLFNBQVNDLEtBQUssR0FDOUUsR0FBQyxrQ0FFRCxXQUNJN0QsS0FBS3VELGVBQWU1QixVQUFVQyxJQUFJNUIsS0FBS2dELFFBQVFpQixxQkFDL0NqRSxLQUFLdUQsZUFBZVcsVUFBVyxDQUNuQyxHQUFDLGlDQUVELFdBQ0lsRSxLQUFLdUQsZUFBZTVCLFVBQVVFLE9BQU83QixLQUFLZ0QsUUFBUWlCLHFCQUNsRGpFLEtBQUt1RCxlQUFlVyxVQUFXLENBQ25DLEdBQUMsZ0NBRUQsV0FDUWxFLEtBQUttRSxtQkFDTG5FLEtBQUtvRSx1QkFFTHBFLEtBQUtxRSxxQkFFYixHQUFDLGdDQUVELFdBQXFCLFdBQ2pCckUsS0FBS3NFLHFCQUNMdEUsS0FBS2tELFdBQVdYLFNBQVEsU0FBQ2tCLEdBQ3JCQSxFQUFhM0IsaUJBQWlCLFNBQVMsV0FDbkMsRUFBS3lDLG9CQUFvQmQsR0FDekIsRUFBS2Esb0JBQ1QsR0FDSixHQUNKLEdBQUMsOEJBRUQsV0FDSXRFLEtBQUswQyxvQkFDVCxHQUFDLHlCQUVELFdBQWMsV0FDVjFDLEtBQUtzRSxxQkFDTHRFLEtBQUtrRCxXQUFXWCxTQUFRLFNBQUNpQyxHQUNyQixFQUFLVixnQkFBZ0JVLEVBQ3pCLEdBQ0osTSxvRUFBQyxFQXJFNkIsRyx1cUJDQWJDLEVBQU8sV0FDeEIsYUFBaUNDLEdBQVUsSUFBN0JDLEVBQUssRUFBTEEsTUFBT0MsRUFBUSxFQUFSQSxVLDRGQUFRLFNBQ3pCNUUsS0FBSzZFLE9BQVNGLEVBQ2QzRSxLQUFLOEUsVUFBWUYsRUFDakI1RSxLQUFLK0UsV0FBYW5FLFNBQVNDLGNBQWM2RCxFQUM3QyxDLFFBUUMsTyxFQVJBLEcsRUFBQSwwQkFFRCxXQUFjLFdBQ1YxRSxLQUFLNkUsT0FBT3RDLFNBQVEsU0FBQUMsR0FBSSxPQUFJLEVBQUtzQyxVQUFVdEMsRUFBSyxHQUNwRCxHQUFDLHFCQUVELFNBQVF3QyxHQUNKaEYsS0FBSytFLFdBQVdFLFFBQVFELEVBQzVCLE0sb0VBQUMsRUFidUIsRyx1cUJDQVBFLEVBQUssV0FDdEIsV0FBWVIsSSw0RkFBVSxTQUNsQjFFLEtBQUttRixPQUFTdkUsU0FBU0MsY0FBYzZELEdBQ3JDMUUsS0FBS29GLGdCQUFrQnBGLEtBQUtvRixnQkFBZ0JDLEtBQUtyRixLQUNyRCxDLFFBcUJDLE8sRUFyQkEsRyxFQUFBLG1CQUVELFdBQ0lBLEtBQUttRixPQUFPeEQsVUFBVUMsSUFBSSxnQkFDMUJoQixTQUFTa0IsaUJBQWlCLFVBQVc5QixLQUFLb0YsZ0JBQzlDLEdBQUMsbUJBRUQsV0FDSXBGLEtBQUttRixPQUFPeEQsVUFBVUUsT0FBTyxnQkFDN0JqQixTQUFTMEUsb0JBQW9CLFVBQVd0RixLQUFLb0YsZ0JBQ2pELEdBQUMsNkJBRUQsU0FBZ0JHLEdBQ0ksV0FBWkEsRUFBSUMsS0FDSnhGLEtBQUt5RixPQUViLEdBQUMsK0JBRUQsV0FDSXpGLEtBQUttRixPQUFPdEUsY0FBYyx3QkFBd0JpQixpQkFBaUIsUUFBUzlCLEtBQUt5RixNQUFNSixLQUFLckYsT0FDNUZBLEtBQUttRixPQUFPdEUsY0FBYyxtQkFBbUJpQixpQkFBaUIsUUFBUzlCLEtBQUt5RixNQUFNSixLQUFLckYsTUFDM0YsTSxvRUFBQyxFQXpCcUIsRyxndkNDQUssSUFFVjBGLEVBQWMsYSxxUkFBQSxVLFFBQUEsRyxFQUFBLEUscXJCQUMvQixXQUFZaEIsR0FBVSxNQUdvRCxPLDRGQUhwRCxVQUNsQixjQUFNQSxJQUNEaUIsWUFBYyxFQUFLUixPQUFPdEUsY0FBYyxlQUM3QyxFQUFLK0UsaUJBQW1CLEVBQUtULE9BQU90RSxjQUFjLHFCQUFvQixDQUMxRSxDQU9DLE8sRUFQQSxHLEVBQUEsbUJBRUQsU0FBS2dGLEVBQU10RyxHQUNQUyxLQUFLMkYsWUFBWXZELElBQU03QyxFQUN2QlMsS0FBSzJGLFlBQVl0RCxJQUFNd0QsRUFDdkI3RixLQUFLNEYsaUJBQWlCeEUsWUFBY3lFLEVBQ3BDLHdDQUNKLE0sb0VBQUMsRUFaOEIsQ0FBU1gsRyxndkNDRmIsSUFFVlksRUFBYSxhLHFSQUFBLFUsUUFBQSxHLEVBQUEsRSxxckJBQzlCLFdBQVlwQixFQUFVcUIsRUFBUUMsR0FBUyxNQUtpQyxPLDRGQUxqQyxVQUNuQyxjQUFNdEIsSUFDRHVCLFFBQVVGLEVBQ2YsRUFBS0csU0FBV0YsRUFDaEIsRUFBS0csV0FBYSxFQUFLaEIsT0FBT3RFLGNBQWMsZ0JBQzVDLEVBQUtxQyxXQUFhLEVBQUtpRCxXQUFXOUMsaUJBQWlCLGlCQUFpQixDQUN4RSxDQXNCQyxPLEVBdEJBLEcsRUFBQSw4QkFFRCxXQUNJLElBQU0rQyxFQUFTLENBQUMsRUFJaEIsT0FIQXBHLEtBQUtrRCxXQUFXWCxTQUFRLFNBQUNDLEdBQ3JCNEQsRUFBTzVELEVBQUsvQyxJQUFNK0MsRUFBSzZELEtBQzNCLElBQ09ELENBQ1gsR0FBQywrQkFFRCxXQUFvQixXQUNoQixzREFDQXBHLEtBQUttRyxXQUFXckUsaUJBQWlCLFVBQVUsU0FBQ3lELEdBQ3hDQSxFQUFJZSxpQkFDSixFQUFLSixVQUFTLEVBQU0sRUFBS0MsWUFDekIsRUFBS0YsUUFBUSxFQUFLTSxrQkFBbUIsRUFBS0osV0FDOUMsR0FDSixHQUFDLG1CQUVELFdBQ0ksMENBQ0FuRyxLQUFLbUcsV0FBV0ssT0FDcEIsTSxvRUFBQyxFQTdCNkIsQ0FBU3RCLEcsdXFCQ0Z0QnVCLEVBQVEsV0FDekIsY0FBZ0MsSUFBbEJaLEVBQUksRUFBSkEsS0FBTWEsRUFBUSxFQUFSQSxVLDRGQUFRLFNBQ3hCMUcsS0FBSzJHLE1BQVFkLEVBQ2I3RixLQUFLNEcsVUFBWUYsQ0FDckIsQyxRQVlDLE8sRUFaQSxHLEVBQUEsMEJBRUQsV0FDSSxNQUFPLENBQ0hiLEtBQU03RixLQUFLMkcsTUFBTXZGLFlBQ2pCc0YsU0FBVTFHLEtBQUs0RyxVQUFVeEYsWUFFakMsR0FBQyx5QkFFRCxTQUFZeUYsR0FDUjdHLEtBQUsyRyxNQUFNdkYsWUFBY3lGLEVBQUloQixLQUM3QjdGLEtBQUs0RyxVQUFVeEYsWUFBY3lGLEVBQUlDLEtBQ3JDLE0sb0VBQUMsRUFoQndCLEcsdXFCQ0FSQyxFQUFHLFdBQ3BCLFdBQVlqRSxJLDRGQUFRLFNBQ2hCOUMsS0FBS2dILElBQU1sRSxFQUFPa0UsSUFDbEJoSCxLQUFLaUgsUUFBVW5FLEVBQU9tRSxPQUMxQixDLFFBd0VDLE8sRUF4RUEsRyxFQUFBLHNCQUVELFdBQ0ksT0FBT0MsTUFBTWxILEtBQUtnSCxJQUFLLENBQ25CQyxRQUFTakgsS0FBS2lILFVBRWJoRyxLQUFLa0csRUFDZCxHQUFDLHNCQUVELFNBQVNqRyxHQUNMLE9BQU9nRyxNQUFNbEgsS0FBS2dILElBQUssQ0FDbkJJLE9BQVEsUUFDUkgsUUFBUyxDQUNMSSxjQUFlLHVDQUNmLGVBQWdCLG9CQUVwQkMsS0FBTUMsS0FBS0MsVUFBVSxDQUNqQjNCLEtBQU0zRSxFQUFLMkUsS0FDWGlCLE1BQU81RixFQUFLd0YsYUFHZnpGLEtBQUtrRyxFQUNkLEdBQUMsdUJBRUQsU0FBVWpHLEdBQ04sT0FBT2dHLE1BQU0sR0FBRCxPQUFJbEgsS0FBS2dILElBQUcsV0FBVyxDQUMvQkksT0FBUSxRQUNSSCxRQUFTLENBQ0xJLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRXBCQyxLQUFNQyxLQUFLQyxVQUFVLENBQ2pCQyxPQUFRdkcsRUFBS3VHLFdBR2hCeEcsS0FBS2tHLEVBQ2QsR0FBQywyQkFFRCxTQUFjakcsR0FDVixPQUFPZ0csTUFBTWxILEtBQUtnSCxJQUFLLENBQ25CSSxPQUFRLE9BQ1JILFFBQVNqSCxLQUFLaUgsUUFDZEssS0FBTUMsS0FBS0MsVUFBVSxDQUNqQjNCLEtBQU0zRSxFQUFLNUIsTUFDWEMsS0FBTTJCLEVBQUszQixTQUdkMEIsS0FBS2tHLEVBQ2QsR0FBQyx3QkFFRCxTQUFXTyxHQUNQLE9BQU9SLE1BQU0sR0FBRCxPQUFJbEgsS0FBS2dILElBQUcsWUFBSVUsR0FBVSxDQUNsQ04sT0FBUSxTQUNSSCxRQUFTakgsS0FBS2lILFVBRWJoRyxLQUFLa0csRUFDZCxHQUFDLHFCQUVELFNBQVFPLEdBQ0osT0FBT1IsTUFBTSxHQUFELE9BQUlsSCxLQUFLZ0gsSUFBRyxZQUFJVSxFQUFNLFVBQVUsQ0FDeENOLE9BQVEsTUFDUkgsUUFBU2pILEtBQUtpSCxVQUViaEcsS0FBS2tHLEVBQ2QsR0FBQyx3QkFFRCxTQUFXTyxHQUNQLE9BQU9SLE1BQU0sR0FBRCxPQUFJbEgsS0FBS2dILElBQUcsWUFBSVUsRUFBTSxVQUFVLENBQ3hDTixPQUFRLFNBQ1JILFFBQVNqSCxLQUFLaUgsVUFFYmhHLEtBQUtrRyxFQUNkLE0sb0VBQUMsRUE1RW1CLEdBK0V4QixTQUFTQSxFQUFlUSxHQUNwQixPQUFJQSxFQUFJQyxHQUNHRCxFQUFJRSxPQUVSQyxRQUFRQyxPQUFPLElBQUlDLE1BQU0sYUFDcEMsQ0NwRkEsSUFlTUMsRUFBbUIsQ0FDckJDLGFBQWMsZUFDZDVFLGNBQWUsZ0JBQ2ZFLGVBQWdCLHNCQUNoQlMsb0JBQXFCLHlCQUNyQlAsZUFBZ0IsMkIsZ3ZDQ3BCVyxJQ21DM0J5RSxFRGpDaUJDLEVBQWUsYSxxUkFBQSxVLFFBQUEsRyxFQUFBLEUscXJCQUNoQyxXQUFZMUQsRUFBVTJELEdBQWEsTUFFRyxPLDRGQUZILFVBQy9CLGNBQU0zRCxJQUNENEQsY0FBZ0JELEVBQWEsQ0FDdEMsQ0FtQkMsTyxFQW5CQSxHLEVBQUEsbUJBRUQsU0FBS0UsRUFBTTlJLEdBQ1BPLEtBQUt3SSxNQUFRRCxFQUNidkksS0FBS0ksSUFBTVgsRUFDWCx3Q0FDSixHQUFDLG9CQUVELFdBQ0lPLEtBQUtzSSxjQUFjdEksS0FBS0ksS0FDeEJKLEtBQUt3SSxNQUFNM0csUUFDZixHQUFDLCtCQUVELFdBQW9CLFdBQ2hCLHNEQUNBN0IsS0FBS21GLE9BQU90RSxjQUFjLDhCQUE4QmlCLGlCQUFpQixTQUFTLFdBQzlFLEVBQUsyRCxRQUNMLEVBQUtnRCxRQUNULEdBQ0osTSxvRUFBQyxFQXZCK0IsQ0FBU3ZELEdDU3ZDd0QsRUFBYTlILFNBQVNDLGNBQWMseUJBQ3BDOEgsRUFBWS9ILFNBQVNDLGNBQWMsd0JBQ25DNEcsRUFBUzdHLFNBQVNDLGNBQWMsMkJBQ2hDK0gsRUFBY2hJLFNBQVNDLGNBQWMsa0JBQ3JDZ0ksRUFBa0JqSSxTQUFTQyxjQUFjLHNCQUN6Q2lJLEVBQWdCbEksU0FBU0MsY0FBYyxxQkFDdkNrSSxFQUFlbkksU0FBU0MsY0FBYyxvQkFDdENtSSxFQUFrQnBJLFNBQVNDLGNBQWMsdUJBQ3pDb0ksRUFBWXJJLFNBQVNDLGNBQWMsU0FDbkNxSSxFQUFnQnRJLFNBQVNDLGNBQWMsYUFDdkNzSSxFQUFnQnZJLFNBQVNDLGNBQWMsb0JBRXZDdUksRUFBb0IsSUFBSXZHLEVBQWNvRixFQUFrQmMsR0FDeERNLEVBQXFCLElBQUl4RyxFQUFjb0YsRUFBa0JhLEdBQ3pEUSxFQUF1QixJQUFJekcsRUFBY29GLEVBQWtCZSxHQUUzRE8sRUFBVSxJQUFJeEMsRUYzQkcsQ0FDbkJDLElBQUssaURBQ0xDLFFBQVMsQ0FDTEksY0FBZSwwQ0V5QmpCbUMsR0FBVyxJQUFJekMsRUZyQkQsQ0FDaEJDLElBQUssb0RBQ0xDLFFBQVMsQ0FDTEksY0FBZSx1Q0FDZixlQUFnQixzQkVtQmxCb0MsR0FBVyxJQUFJaEQsRUFBUyxDQUMxQlosS0FBTStDLEVBQ05sQyxTQUFVbUMsSUFLZFcsR0FBU0UsVUFDSnpJLE1BQUssU0FBQ0MsSUFDSGlILEVBQVksSUFBSTFELEVBQVEsQ0FDcEJFLE1BQU96RCxFQUNQMEQsU0FBVSxTQUFDcEMsR0FDUCxJQUFNK0YsRUFBT29CLEdBQVduSCxFQUFLcUQsS0FBTXJELEVBQUtqRCxLQUFNaUQsRUFBS2hELE1BQU9nRCxFQUFLcEMsSUFBS29DLEVBQUtvSCxNQUFNeEosS0FDL0UrSCxFQUFVMEIsUUFBUXRCLEVBQUt1QixVQUMzQixHQUVBLGdCQUVNQyxhQUNkLElBQUd6SSxPQUFNLFNBQUNDLEdBQ05DLFFBQVFDLElBQUlGLEVBQ2hCLElBR0pnSSxFQUFRRyxVQUNIekksTUFBSyxTQUFDQyxHQUNIdUksR0FBU08sWUFBWTlJLEdBQ3JCaUksRUFBYy9HLElBQU1sQixFQUFLdUcsTUFDN0IsSUFDQ25HLE9BQU0sU0FBQ0MsR0FDSkMsUUFBUUMsSUFBSUYsRUFDaEIsSUFFSixJQUFNMEksR0FBWSxJQUFJbkUsRUFBYyxlQWNwQyxTQUErQm9FLEVBQVdDLEdBQ3RDWixFQUFRYSxTQUFTRixHQUNaakosTUFBSyxTQUFDQyxHQUNIdUksR0FBU08sWUFBWTlJLEVBQ3pCLElBQ0NJLE9BQU0sU0FBQ0MsR0FDSkMsUUFBUUMsSUFBSUYsRUFDaEIsSUFDQzhJLFNBQVEsV0FDTEMsSUFBYyxFQUFPSCxHQUNyQkYsR0FBVXhFLE9BQ2QsR0FDUixHQTFCMEU2RSxJQUNwRUMsR0FBVyxJQUFJekUsRUFBYyxjQTJCbkMsU0FBOEJvRSxFQUFXQyxHQUNyQ1gsR0FBU2dCLGNBQWNOLEdBQ2xCakosTUFBSyxTQUFDQyxHQUNILElBQU1xSCxFQUFPb0IsR0FBV3pJLEVBQUsyRSxLQUFNM0UsRUFBSzNCLEtBQU0yQixFQUFLMUIsTUFBTzBCLEVBQUtkLElBQUtjLEVBQUswSSxNQUFNeEosS0FDL0UrSCxFQUFVMEIsUUFBUXRCLEVBQUt1QixVQUMzQixJQUNDeEksT0FBTSxTQUFDQyxHQUNKQyxRQUFRQyxJQUFJRixFQUNoQixJQUNDOEksU0FBUSxXQUNMQyxJQUFjLEVBQU9ILEdBQ3JCSSxHQUFTOUUsT0FDYixHQUNSLEdBeEN1RTZFLElBQ2pFRyxHQUFpQixJQUFJM0UsRUFBYyxpQkF5Q3pDLFNBQWlDb0UsRUFBV0MsR0FDeENaLEVBQVFtQixVQUFVUixHQUNiakosTUFBSyxTQUFDQyxHQUNIaUksRUFBYy9HLElBQU1sQixFQUFLdUcsTUFDN0IsSUFDQ25HLE9BQU0sU0FBQ0MsR0FDSkMsUUFBUUMsSUFBSUYsRUFDaEIsSUFDQzhJLFNBQVEsV0FDTEMsSUFBYyxFQUFPSCxHQUNyQk0sR0FBZWhGLE9BQ25CLEdBQ1IsR0FyRG1GNkUsSUFDN0VLLEdBQWlCLElBQUlqRixFQUFlLHFCQUNwQ2tGLEdBQWtCLElBQUl4QyxFQUFnQixpQkFxRDVDLFNBQXNCVixHQUNsQjhCLEdBQVNxQixXQUFXbkQsRUFDeEIsSUFyREEsU0FBUzRDLEdBQWNRLEVBQVdYLEdBRTFCQSxFQUFVdEosY0FBYyx1QkFBdUJPLFlBRC9DMEosRUFDNkQsZ0JBRUEsU0FFckUsQ0FpREEsU0FBU2pMLEdBQVc2SCxHQUNoQixPQUFPOEIsR0FBU3VCLFFBQVFyRCxFQUM1QixDQUVBLFNBQVM1SCxHQUFjNEgsR0FDbkIsT0FBTzhCLEdBQVN3QixXQUFXdEQsRUFDL0IsQ0FFQSxTQUFTL0gsR0FBbUJrRyxFQUFNdEcsR0FDOUJvTCxHQUFlTSxLQUFLcEYsRUFBTXRHLEVBQzlCLENBRUEsU0FBU0ssR0FBb0IySSxFQUFNOUksR0FDL0JtTCxHQUFnQkssS0FBSzFDLEVBQU05SSxFQUMvQixDQUVBLFNBQVNrSyxHQUFXOUQsRUFBTXRHLEVBQU1DLEVBQU9DLEVBQUlDLEdBRXZDLE9BRGEsSUFBSUwsRUFBS3dHLEVBQU10RyxFQUFNQyxFQUFPQyxFQUFJQyxFQUFTQyxHQUFvQkMsR0FBcUJDLEdBQVlDLEdBQWUsdUJBRTlILENBRUE0SSxFQUFXNUcsaUJBQWlCLFNBQVMsV0FDakMsSUFBTW9KLEVBQWF6QixHQUFTMEIsY0FDNUJsQyxFQUFVNUMsTUFBUTZFLEVBQVdyRixLQUM3QnFELEVBQWM3QyxNQUFRNkUsRUFBV3hFLFNBQ2pDMkMsRUFBbUIrQixjQUNuQm5CLEdBQVVnQixNQUNkLElBRUF0QyxFQUFVN0csaUJBQWlCLFNBQVMsV0FDaENzSCxFQUFrQmdDLGNBQ2xCYixHQUFTVSxNQUNiLElBRUF4RCxFQUFPM0YsaUJBQWlCLFNBQVMsV0FDN0IySSxHQUFlUSxNQUNuQixJQUlBVixHQUFTYyxvQkFDVHBCLEdBQVVvQixvQkFDVlYsR0FBZVUsb0JBQ2ZULEdBQWdCUyxvQkFDaEJaLEdBQWVZLG9CQUVmakMsRUFBa0JrQyxtQkFDbEJqQyxFQUFtQmlDLG1CQUNuQmhDLEVBQXFCZ0Msa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29uc3RhbnRzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEJ1dHRvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKHRpdGxlLCBsaW5rLCBsaWtlcywgaWQsIG93bmVySWQsIG9wZW5GdWxsSW1hZ2VQb3B1cCwgb3BlbkRlbGV0ZUNhcmRQb3B1cCwgcHV0TGlrZUFwaSwgZGVsZXRlTGlrZUFwaSwgdGVtcGxhdGVTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3RpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgICAgICB0aGlzLl9pZCA9IGlkO1xyXG4gICAgICAgIHRoaXMuX293bmVySWQgPSBvd25lcklkO1xyXG4gICAgICAgIHRoaXMuX29wZW5GdWxsSW1hZ2VQb3B1cCA9IG9wZW5GdWxsSW1hZ2VQb3B1cDtcclxuICAgICAgICB0aGlzLl9vcGVuRGVsZXRlQ2FyZFBvcHVwID0gb3BlbkRlbGV0ZUNhcmRQb3B1cDtcclxuICAgICAgICB0aGlzLl9wdXRMaWtlQXBpID0gcHV0TGlrZUFwaTtcclxuICAgICAgICB0aGlzLl9kZWxldGVMaWtlQXBpID0gZGVsZXRlTGlrZUFwaTtcclxuICAgICAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9jb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKS5jb250ZW50XHJcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWdyaWRfX2VsZW1lbnRcIik7XHJcbiAgICAgICAgdGhpcy5fbXlJZCA9ICc0MjVkNTQxNDEyMTI1MTBjODUzY2YwNDcnO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRUZW1wbGF0ZUNhcmQoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuX2NvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIHJldHVybiBjYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIF9wdXRMaWtlKCkge1xyXG4gICAgICAgIHRoaXMuX3B1dExpa2VBcGkodGhpcy5faWQpXHJcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+ICB0aGlzLl9saWtlc0NvdW50LnRleHRDb250ZW50ID0gZGF0YS5saWtlcy5sZW5ndGgpXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsgLy8g0LLRi9Cy0LXQtNC10Lwg0L7RiNC40LHQutGDINCyINC60L7QvdGB0L7Qu9GMXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2xpa2UuY2xhc3NMaXN0LmFkZCgncGhvdG8tZ3JpZF9fbGlrZV9hY3RpdmUnKTtcclxuICAgIH1cclxuXHJcbiAgICBfZGVsZXRlTGlrZSgpIHtcclxuICAgICAgICB0aGlzLl9kZWxldGVMaWtlQXBpKHRoaXMuX2lkKVxyXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiAgdGhpcy5fbGlrZXNDb3VudC50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoKVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC10LTQtdC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9saWtlLmNsYXNzTGlzdC5yZW1vdmUoJ3Bob3RvLWdyaWRfX2xpa2VfYWN0aXZlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2xpa2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9saWtlLmNsYXNzTGlzdC5jb250YWlucygncGhvdG8tZ3JpZF9fbGlrZV9hY3RpdmUnKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGVsZXRlTGlrZSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHV0TGlrZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZ3JpZF9fZGVsZXRlLWJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5fb3BlbkRlbGV0ZUNhcmRQb3B1cCh0aGlzLl9uZXdDYXJkLCB0aGlzLl9pZCkpO1xyXG4gICAgICAgIHRoaXMuX2ltZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX29wZW5GdWxsSW1hZ2VQb3B1cCh0aGlzLl90aXRsZSwgdGhpcy5fbGluaykpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXREYXRhKCkge1xyXG4gICAgICAgIGNvbnN0IHRpdGxlID0gdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZ3JpZF9fdGl0bGUnKTtcclxuICAgICAgICB0aXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgICAgIHRoaXMuX2ltZy5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIHRoaXMuX2ltZy5hbHQgPSB0aGlzLl90aXRsZTtcclxuICAgICAgICB0aGlzLl9saWtlc0NvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lkKCkge1xyXG4gICAgICAgIGxldCByZXN1bHQ7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5faWQgPT09IHRoaXMuX215SWQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VmlldygpIHtcclxuICAgICAgICB0aGlzLl9uZXdDYXJkID0gdGhpcy5fZ2V0VGVtcGxhdGVDYXJkKCk7XHJcbiAgICAgICAgdGhpcy5faW1nID0gdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZ3JpZF9fcGhvdG8nKTtcclxuICAgICAgICB0aGlzLl9saWtlID0gdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZ3JpZF9fbGlrZScpO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzQ291bnQgPSB0aGlzLl9uZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5waG90by1ncmlkX19saWtlcy1jb3VudGVyJyk7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICB0aGlzLl9zZXREYXRhKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9teUlkICE9PSB0aGlzLl9vd25lcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcignLnBob3RvLWdyaWRfX2RlbGV0ZS1idXR0b24nKS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMuX2NoZWNrSWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlLmNsYXNzTGlzdC5hZGQoJ3Bob3RvLWdyaWRfX2xpa2VfYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fbmV3Q2FyZDtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5idXR0b25TZWxlY3Rvcik7XHJcbiAgICB9IFxyXG5cclxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLnJlZEJvcmRlckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcucmVkQm9yZGVyQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIF9kaXNhYmxlU3VibWl0QnV0dG9uKCkge1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgX2VuYWJsZVN1Ym1pdEJ1dHRvbigpIHtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVTdWJtaXRCdXR0b24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9lbmFibGVTdWJtaXRCdXR0b24oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhckVycm9ycygpIHtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2xvc2UtYnV0dG9uJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fb3ZlcmxheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZS5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xyXG4gICAgICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWcnKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlVGl0bGUgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltZy10aXRsZScpXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBzdWJtaXQsIGxvYWRpbmcpIHtcclxuICAgICAgICBzdXBlcihzZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0ID0gc3VibWl0O1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmcgPSBsb2FkaW5nO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7ICAgIFxyXG4gICAgICAgICAgICB2YWx1ZXNbaXRlbS5pZF0gPSBpdGVtLnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZXM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5fbG9hZGluZyh0cnVlLCB0aGlzLl9wb3B1cEZvcm0pO1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSwgdGhpcy5fcG9wdXBGb3JtKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoeyBuYW1lLCB2b2NhdGlvbiB9KSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fdm9jYXRpb24gPSB2b2NhdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICB2b2NhdGlvbjogdGhpcy5fdm9jYXRpb24udGV4dENvbnRlbnRcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckluZm8ob2JqKSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG9iai5uYW1lO1xyXG4gICAgICAgIHRoaXMuX3ZvY2F0aW9uLnRleHRDb250ZW50ID0gb2JqLmFib3V0O1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZykge1xyXG4gICAgICAgIHRoaXMudXJsID0gY29uZmlnLnVybDtcclxuICAgICAgICB0aGlzLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycztcclxuICAgIH1cclxuXHJcbiAgICBnZXRJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLnVybCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihoYW5kbGVSZXNwb25zZSlcclxuICAgIH1cclxuXHJcbiAgICBzYXZlSW5mbyhkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMudXJsLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogJ2RhY2IxMzQzLTVlZTUtNGMzNS05OTBkLTViZjdiMmY3Y2M3OScsXHJcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0OiBkYXRhLnZvY2F0aW9uXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oaGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgc2V0QXZhdGFyKGRhdGEpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICBhdXRob3JpemF0aW9uOiAnZGFjYjEzNDMtNWVlNS00YzM1LTk5MGQtNWJmN2IyZjdjYzc5JyxcclxuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhclxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKGhhbmRsZVJlc3BvbnNlKVxyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZU5ld0NhcmQoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLnVybCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgbGluazogZGF0YS5saW5rXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oaGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9LyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oaGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgcHV0TGlrZShjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9LyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oaGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlTGlrZShjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9LyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oaGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVJlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcign0J7RiNC40LHQutCwISEhJykpXHJcbn0iLCJjb25zdCB1c2VySW5mb0NvbmZpZyA9IHtcclxuICAgIHVybDogJ2h0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNjAvdXNlcnMvbWUnLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246ICdkYWNiMTM0My01ZWU1LTRjMzUtOTkwZC01YmY3YjJmN2NjNzknXHJcbiAgICAgIH1cclxufVxyXG5cclxuY29uc3QgY2FyZHNDb25maWcgPSB7XHJcbiAgICB1cmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTYwL2NhcmRzJyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiAnZGFjYjEzNDMtNWVlNS00YzM1LTk5MGQtNWJmN2IyZjdjYzc5JyxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxyXG4gICAgYnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3NhdmUtYnV0dG9uJyxcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9faW5hY3RpdmUtYnV0dG9uJyxcclxuICAgIHJlZEJvcmRlckNsYXNzOiAncG9wdXBfX2lucHV0X3JlZC1icm9kZXInXHJcbn1cclxuXHJcbmV4cG9ydCB7dmFsaWRhdGlvbkNvbmZpZywgdXNlckluZm9Db25maWcsIGNhcmRzQ29uZmlnfTsiLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEJ1dHRvbiBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBoYW5kbGVCdXR0b24pe1xyXG4gICAgICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVCdXR0b24gPSBoYW5kbGVCdXR0b247XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihjYXJkLCBpZCl7XHJcbiAgICAgICAgdGhpcy5fY2FyZCA9IGNhcmQ7XHJcbiAgICAgICAgdGhpcy5faWQgPSBpZDtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlKCl7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQnV0dG9uKHRoaXMuX2lkKTtcclxuICAgICAgICB0aGlzLl9jYXJkLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19kZWxldGUtY2FyZC1idXR0b24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmRlbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7IHZhbGlkYXRpb25Db25maWcsIHVzZXJJbmZvQ29uZmlnLCBjYXJkc0NvbmZpZyB9IGZyb20gXCIuLi9jb25zdGFudHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCAnLi9pbmRleC5jc3MnO1xyXG5pbXBvcnQgUG9wdXBXaXRoQnV0dG9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEJ1dHRvbi5qc1wiO1xyXG5cclxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5jb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5jb25zdCBhdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyLXBlbmNpbCcpO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19uYW1lJyk7XHJcbmNvbnN0IHByb2ZpbGVWb2NhdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX192b2NhdGlvbicpO1xyXG5jb25zdCBwb3B1cEVkaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19lZGl0LWZvcm0nKTtcclxuY29uc3QgcG9wdXBBZGRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19hZGQtZm9ybScpO1xyXG5jb25zdCBwb3B1cEF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2F2YXRhci1mb3JtJyk7XHJcbmNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJyk7XHJcbmNvbnN0IGlucHV0Vm9jYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdm9jYXRpb24nKTtcclxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXInKTtcclxuXHJcbmNvbnN0IHZhbGlkYXRpb25BZGRGb3JtID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgcG9wdXBBZGRGb3JtKTtcclxuY29uc3QgdmFsaWRhdGlvbkVkaXRGb3JtID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgcG9wdXBFZGl0Rm9ybSk7XHJcbmNvbnN0IHZhbGlkYXRpb25BdmF0YXJGb3JtID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgcG9wdXBBdmF0YXJGb3JtKTtcclxuXHJcbmNvbnN0IHVzZXJBcGkgPSBuZXcgQXBpKHVzZXJJbmZvQ29uZmlnKTtcclxuY29uc3QgY2FyZHNBcGkgPSBuZXcgQXBpKGNhcmRzQ29uZmlnKTtcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICAgIG5hbWU6IHByb2ZpbGVOYW1lLFxyXG4gICAgdm9jYXRpb246IHByb2ZpbGVWb2NhdGlvblxyXG59KTtcclxuXHJcbmxldCBjYXJkc0dyaWQ7XHJcblxyXG5jYXJkc0FwaS5nZXRJbmZvKClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgY2FyZHNHcmlkID0gbmV3IFNlY3Rpb24oe1xyXG4gICAgICAgICAgICBpdGVtczogZGF0YSxcclxuICAgICAgICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChpdGVtLm5hbWUsIGl0ZW0ubGluaywgaXRlbS5saWtlcywgaXRlbS5faWQsIGl0ZW0ub3duZXIuX2lkKTtcclxuICAgICAgICAgICAgICAgIGNhcmRzR3JpZC5hZGRJdGVtKGNhcmQuZ2V0VmlldygpKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICAgICAgICAnLnBob3RvLWdyaWQnXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjYXJkc0dyaWQucmVuZGVySXRlbXMoKTtcclxuICAgIH0pLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpOyAvLyDQstGL0LLQtdC00LXQvCDQvtGI0LjQsdC60YMg0LIg0LrQvtC90YHQvtC70YxcclxuICAgIH0pO1xyXG5cclxuXHJcbnVzZXJBcGkuZ2V0SW5mbygpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpOyAvLyDQstGL0LLQtdC00LXQvCDQvtGI0LjQsdC60YMg0LIg0LrQvtC90YHQvtC70YxcclxuICAgIH0pO1xyXG5cclxuY29uc3QgcG9wdXBFZGl0ID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF9lZGl0JywgaGFuZGxlU3VibWl0UG9wdXBFZGl0LCByZW5kZXJMb2FkaW5nKTtcclxuY29uc3QgcG9wdXBBZGQgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX2FkZCcsIGhhbmRsZVN1Ym1pdFBvcHVwQWRkLCByZW5kZXJMb2FkaW5nKTtcclxuY29uc3QgcG9wdXBTZXRBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX2F2YXRhcicsIGhhbmRsZVN1Ym1pdFBvcHVwQXZhdGFyLCByZW5kZXJMb2FkaW5nKTtcclxuY29uc3QgcG9wdXBGdWxsSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF9mdWxsLWltYWdlJyk7XHJcbmNvbnN0IHBvcHVwRGVsZXRlQ2FyZCA9IG5ldyBQb3B1cFdpdGhCdXR0b24oJy5wb3B1cF9kZWxldGUnLCBoYW5kbGVCdXR0b24pO1xyXG5cclxuZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIHBvcHVwRm9ybSkge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICAgIHBvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnV0dG9uJykudGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBwb3B1cEZvcm0ucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJ9Ch0L7Qt9C00LDRgtGMJztcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlU3VibWl0UG9wdXBFZGl0KGlucHV0RGF0YSwgcG9wdXBGb3JtKSB7XHJcbiAgICB1c2VyQXBpLnNhdmVJbmZvKGlucHV0RGF0YSlcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC10LTQtdC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBwb3B1cEZvcm0pO1xyXG4gICAgICAgICAgICBwb3B1cEVkaXQuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlU3VibWl0UG9wdXBBZGQoaW5wdXREYXRhLCBwb3B1cEZvcm0pIHtcclxuICAgIGNhcmRzQXBpLmNyZWF0ZU5ld0NhcmQoaW5wdXREYXRhKVxyXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGRhdGEubmFtZSwgZGF0YS5saW5rLCBkYXRhLmxpa2VzLCBkYXRhLl9pZCwgZGF0YS5vd25lci5faWQpO1xyXG4gICAgICAgICAgICBjYXJkc0dyaWQuYWRkSXRlbShjYXJkLmdldFZpZXcoKSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC10LTQtdC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBwb3B1cEZvcm0pO1xyXG4gICAgICAgICAgICBwb3B1cEFkZC5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVTdWJtaXRQb3B1cEF2YXRhcihpbnB1dERhdGEsIHBvcHVwRm9ybSkge1xyXG4gICAgdXNlckFwaS5zZXRBdmF0YXIoaW5wdXREYXRhKVxyXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOyAvLyDQstGL0LLQtdC00LXQvCDQvtGI0LjQsdC60YMg0LIg0LrQvtC90YHQvtC70YxcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgcG9wdXBGb3JtKTtcclxuICAgICAgICAgICAgcG9wdXBTZXRBdmF0YXIuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQnV0dG9uKGNhcmRJZCkge1xyXG4gICAgY2FyZHNBcGkuZGVsZXRlQ2FyZChjYXJkSWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwdXRMaWtlQXBpKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGNhcmRzQXBpLnB1dExpa2UoY2FyZElkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVsZXRlTGlrZUFwaShjYXJkSWQpIHtcclxuICAgIHJldHVybiBjYXJkc0FwaS5kZWxldGVMaWtlKGNhcmRJZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5GdWxsSW1hZ2VQb3B1cChuYW1lLCBsaW5rKSB7XHJcbiAgICBwb3B1cEZ1bGxJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuRGVsZXRlQ2FyZFBvcHVwKGNhcmQsIGlkKSB7XHJcbiAgICBwb3B1cERlbGV0ZUNhcmQub3BlbihjYXJkLCBpZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQobmFtZSwgbGluaywgbGlrZXMsIGlkLCBvd25lcklkKSB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQobmFtZSwgbGluaywgbGlrZXMsIGlkLCBvd25lcklkLCBvcGVuRnVsbEltYWdlUG9wdXAsIG9wZW5EZWxldGVDYXJkUG9wdXAsIHB1dExpa2VBcGksIGRlbGV0ZUxpa2VBcGksICcjcGhvdG8tZ3JpZF9fZWxlbWVudCcpO1xyXG4gICAgcmV0dXJuIGNhcmQ7XHJcbn1cclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBjb25zdCB1c2VyT2JqZWN0ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICAgIGlucHV0TmFtZS52YWx1ZSA9IHVzZXJPYmplY3QubmFtZTtcclxuICAgIGlucHV0Vm9jYXRpb24udmFsdWUgPSB1c2VyT2JqZWN0LnZvY2F0aW9uO1xyXG4gICAgdmFsaWRhdGlvbkVkaXRGb3JtLmNsZWFyRXJyb3JzKCk7XHJcbiAgICBwb3B1cEVkaXQub3BlbigpO1xyXG59KTtcclxuXHJcbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIHZhbGlkYXRpb25BZGRGb3JtLmNsZWFyRXJyb3JzKCk7XHJcbiAgICBwb3B1cEFkZC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgcG9wdXBTZXRBdmF0YXIub3BlbigpO1xyXG59KTtcclxuXHJcblxyXG5cclxucG9wdXBBZGQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucG9wdXBFZGl0LnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvcHVwRnVsbEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvcHVwRGVsZXRlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wb3B1cFNldEF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxudmFsaWRhdGlvbkFkZEZvcm0uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG52YWxpZGF0aW9uRWRpdEZvcm0uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG52YWxpZGF0aW9uQXZhdGFyRm9ybS5lbmFibGVWYWxpZGF0aW9uKCk7Il0sIm5hbWVzIjpbIkNhcmQiLCJ0aXRsZSIsImxpbmsiLCJsaWtlcyIsImlkIiwib3duZXJJZCIsIm9wZW5GdWxsSW1hZ2VQb3B1cCIsIm9wZW5EZWxldGVDYXJkUG9wdXAiLCJwdXRMaWtlQXBpIiwiZGVsZXRlTGlrZUFwaSIsInRlbXBsYXRlU2VsZWN0b3IiLCJ0aGlzIiwiX3RpdGxlIiwiX2xpbmsiLCJfbGlrZXMiLCJfaWQiLCJfb3duZXJJZCIsIl9vcGVuRnVsbEltYWdlUG9wdXAiLCJfb3BlbkRlbGV0ZUNhcmRQb3B1cCIsIl9wdXRMaWtlQXBpIiwiX2RlbGV0ZUxpa2VBcGkiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9jb250ZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsIl9teUlkIiwiY2xvbmVOb2RlIiwidGhlbiIsImRhdGEiLCJfbGlrZXNDb3VudCIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiX2xpa2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJfZGVsZXRlTGlrZSIsIl9wdXRMaWtlIiwiX25ld0NhcmQiLCJfaW1nIiwic3JjIiwiYWx0IiwicmVzdWx0IiwiZm9yRWFjaCIsIml0ZW0iLCJfZ2V0VGVtcGxhdGVDYXJkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX3NldERhdGEiLCJfY2hlY2tJZCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9jb25maWciLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsImJ1dHRvblNlbGVjdG9yIiwiaW5wdXRFbGVtZW50IiwicmVkQm9yZGVyQ2xhc3MiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJzb21lIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9kaXNhYmxlU3VibWl0QnV0dG9uIiwiX2VuYWJsZVN1Ym1pdEJ1dHRvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJpbnB1dCIsIlNlY3Rpb24iLCJzZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJQb3B1cFdpdGhJbWFnZSIsIl9wb3B1cEltYWdlIiwiX3BvcHVwSW1hZ2VUaXRsZSIsIm5hbWUiLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0IiwibG9hZGluZyIsIl9zdWJtaXQiLCJfbG9hZGluZyIsIl9wb3B1cEZvcm0iLCJ2YWx1ZXMiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0IiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJVc2VySW5mbyIsInZvY2F0aW9uIiwiX25hbWUiLCJfdm9jYXRpb24iLCJvYmoiLCJhYm91dCIsIkFwaSIsInVybCIsImhlYWRlcnMiLCJmZXRjaCIsImhhbmRsZVJlc3BvbnNlIiwibWV0aG9kIiwiYXV0aG9yaXphdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXZhdGFyIiwiY2FyZElkIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsIkVycm9yIiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImNhcmRzR3JpZCIsIlBvcHVwV2l0aEJ1dHRvbiIsImhhbmRsZUJ1dHRvbiIsIl9oYW5kbGVCdXR0b24iLCJjYXJkIiwiX2NhcmQiLCJkZWxldGUiLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlVm9jYXRpb24iLCJwb3B1cEVkaXRGb3JtIiwicG9wdXBBZGRGb3JtIiwicG9wdXBBdmF0YXJGb3JtIiwiaW5wdXROYW1lIiwiaW5wdXRWb2NhdGlvbiIsInByb2ZpbGVBdmF0YXIiLCJ2YWxpZGF0aW9uQWRkRm9ybSIsInZhbGlkYXRpb25FZGl0Rm9ybSIsInZhbGlkYXRpb25BdmF0YXJGb3JtIiwidXNlckFwaSIsImNhcmRzQXBpIiwidXNlckluZm8iLCJnZXRJbmZvIiwiY3JlYXRlQ2FyZCIsIm93bmVyIiwiYWRkSXRlbSIsImdldFZpZXciLCJyZW5kZXJJdGVtcyIsInNldFVzZXJJbmZvIiwicG9wdXBFZGl0IiwiaW5wdXREYXRhIiwicG9wdXBGb3JtIiwic2F2ZUluZm8iLCJmaW5hbGx5IiwicmVuZGVyTG9hZGluZyIsInBvcHVwQWRkIiwiY3JlYXRlTmV3Q2FyZCIsInBvcHVwU2V0QXZhdGFyIiwic2V0QXZhdGFyIiwicG9wdXBGdWxsSW1hZ2UiLCJwb3B1cERlbGV0ZUNhcmQiLCJkZWxldGVDYXJkIiwiaXNMb2FkaW5nIiwicHV0TGlrZSIsImRlbGV0ZUxpa2UiLCJvcGVuIiwidXNlck9iamVjdCIsImdldFVzZXJJbmZvIiwiY2xlYXJFcnJvcnMiLCJzZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9